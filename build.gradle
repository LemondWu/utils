allprojects {
    apply plugin: 'maven'
    apply plugin: 'idea'

    tasks.withType(JavaCompile) {
        sourceCompatibility = 1.7
        targetCompatibility = 1.7
        options.encoding = 'utf-8'
    }
}

idea.project {
    jdkName = '1.7'
    languageLevel = '1.7'
}

subprojects {
    ext.log4jVersion = '1.2.17'
    ext.junitVersion = '4.11'

    repositories {
        mavenCentral()
    }
}

idea {
    project {
        ipr.withXml { xmlFile ->
            // setup Git root
            xmlFile.asNode().component.find { it.@name == 'VcsDirectoryMappings' }.replaceNode {
                component(name: 'VcsDirectoryMappings') {
                    mapping(directory: "", vcs: "")
                    mapping(directory: "\$PROJECT_DIR\$", vcs: 'Git')
                }
            }
        }
    }
}